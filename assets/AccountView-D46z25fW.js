import{d as R,g as J,c as i,o as a,n as K,a as e,h as g,t as f,_ as I,i as Y,j as T,v as Q,k as X,l as Z,m as j,p as ee,r as M,q as te,x as w,y as se,b as m,z as L,F as b,A as x,w as h,B as A,C as ae,e as B,P as z,D as ne,E as le,G as oe,H as ie,f as P,I as re,J as de,K as ue,M as ce,N as H,O as ve,Q as me,R as pe,S as ge}from"./app-BN5AlkEj.js";import{C as W}from"./CenteredLayout-B6eAq_PD.js";const fe="/images/icons/exchange.svg",_e={class:"icon"},he={key:0,width:"32",height:"32",viewBox:"0 0 32 32",fill:"none"},ye={key:1,width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#3b4252","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},ke={key:2,width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#3b4252","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},be={key:3,src:fe,width:"32",height:"32"},we={class:"label"},$e=R({__name:"MenuButton",props:{label:{},icon:{},active:{type:Boolean}},setup(_){const u=J(),c=_,n=()=>u.push({name:c.label.toLowerCase()});return(s,d)=>(a(),i("button",{class:K(["portfolio-btn",{active:s.active}]),onClick:n},[e("span",_e,[s.icon==="portfolio"?(a(),i("svg",he,d[0]||(d[0]=[e("rect",{x:"6",y:"6",width:"14",height:"20",rx:"2",stroke:"#444","stroke-width":"2",fill:"#fff"},null,-1),e("rect",{x:"10",y:"12",width:"6",height:"6",rx:"1",stroke:"#444","stroke-width":"1.5",fill:"#fff"},null,-1),e("rect",{x:"8",y:"8",width:"14",height:"20",rx:"2",stroke:"#bbb","stroke-width":"1"},null,-1)]))):s.icon==="heart"?(a(),i("svg",ye,d[1]||(d[1]=[e("path",{d:"M19.5 12.572l-7.5 7.428l-7.5-7.428a5 5 0 1 1 7.5-6.566a5 5 0 1 1 7.5 6.572"},null,-1)]))):s.icon==="gear"?(a(),i("svg",ke,d[2]||(d[2]=[e("circle",{cx:"12",cy:"12",r:"3"},null,-1),e("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33h.09A1.65 1.65 0 0 0 9 3.09V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51h.09a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82v.09a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"},null,-1)]))):g("",!0),s.icon==="exchange"?(a(),i("img",be)):g("",!0)]),e("span",we,f(s.label),1)],2))}}),N=I($e,[["__scopeId","data-v-b8091c95"]]),Ce={class:"toggle-container"},Ve={class:"switch-label"},xe={class:"switch-text"},Re=R({__name:"ToggleSwitch",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(_){const u=Y(_,"modelValue");return(c,n)=>(a(),i("div",Ce,[e("label",Ve,[T(e("input",{type:"checkbox","onUpdate:modelValue":n[0]||(n[0]=s=>u.value=s),class:"switch-input"},null,512),[[Q,u.value]]),n[1]||(n[1]=e("span",{class:"switch-slider"},null,-1)),e("span",xe,[X(c.$slots,"default",{},void 0)])])]))}}),U=I(Re,[["__scopeId","data-v-823dee4c"]]),Ie={class:"form-group"},Se={class:"form-group"},Ae={class:"form-group"},Ue=["src"],Be={key:0,class:"icon-list"},Pe=["onClick"],Me=["src"],Fe={class:"form-group"},Ne={class:"form-group"},Te=["value"],De=41,Ge=R({__name:"SettingsForm",setup(_){const{rarity_rules:u,...c}=Z(),n=j({pseudo:"",icon:"000",language:"",accept_notifications:!0,...c,friend_id:ee()}),s=M(!1),d=M(!1),v=j({C:!0,U:!0,R:!0,RR:!0,AR:!0,...(u||[]).reduce((y,t)=>({...y,[t.rarity]:t.enabled===1}),{})}),D=["ENG","SPA","FRA","GER","ITA","POR","JPN","KOR","CHT"];te(()=>[n,v],()=>{d.value=!1},{deep:!0});const G=w(()=>`/images/avatars/${n.icon||"000"}.png`),O=y=>{n.icon=String(y).padStart(3,"0"),s.value=!1},F=async()=>{ne({...n,rarity_rules:Object.entries(v).map(([y,t])=>({rarity:y,enabled:t?1:0}))}),d.value=await le()||!1};return(y,t)=>(a(),i("form",{class:"friend-form",onSubmit:se(F,["prevent"])},[t[16]||(t[16]=e("h2",null,"Settings",-1)),e("div",Ie,[t[10]||(t[10]=e("label",{for:"friendId",class:"form-label"},'Friend ID (16 digits without "-")',-1)),T(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>n.friend_id=o),required:"",type:"text",id:"friendId",class:"friend-id",placeholder:"0000000000000000",pattern:"\\d{16}",maxlength:"16"},null,512),[[L,n.friend_id]])]),e("div",Se,[t[11]||(t[11]=e("label",{for:"pseudo",class:"form-label"},"Pseudonym (14 characters max)",-1)),T(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>n.pseudo=o),type:"text",id:"pseudo",class:"friend-id",maxlength:"14"},null,512),[[L,n.pseudo]])]),e("div",Ae,[t[12]||(t[12]=e("label",{for:"icon",class:"form-label"},"Profile Icon",-1)),e("div",{class:"selected-icon",onClick:t[2]||(t[2]=o=>s.value=!s.value)},[e("img",{src:G.value,alt:"Selected Icon",id:"icon"},null,8,Ue)]),s.value?(a(),i("div",Be,[(a(),i(b,null,x(De,o=>e("div",{key:o,class:"icon-item",onClick:r=>O(o)},[e("img",{src:`/images/avatars/${String(o).padStart(3,"0")}.png`,alt:"Icon"},null,8,Me)],8,Pe)),64))])):g("",!0)]),e("div",Fe,[t[13]||(t[13]=e("label",{class:"form-label"},"Accept exchange of rarity:",-1)),m(U,{modelValue:v.C,"onUpdate:modelValue":t[3]||(t[3]=o=>v.C=o)},{default:h(()=>[m(A,{rarity:"C"})]),_:1},8,["modelValue"]),m(U,{modelValue:v.U,"onUpdate:modelValue":t[4]||(t[4]=o=>v.U=o)},{default:h(()=>[m(A,{rarity:"U"})]),_:1},8,["modelValue"]),m(U,{modelValue:v.R,"onUpdate:modelValue":t[5]||(t[5]=o=>v.R=o)},{default:h(()=>[m(A,{rarity:"R"})]),_:1},8,["modelValue"]),m(U,{modelValue:v.RR,"onUpdate:modelValue":t[6]||(t[6]=o=>v.RR=o)},{default:h(()=>[m(A,{rarity:"RR"})]),_:1},8,["modelValue"]),m(U,{modelValue:v.AR,"onUpdate:modelValue":t[7]||(t[7]=o=>v.AR=o)},{default:h(()=>[m(A,{rarity:"AR"})]),_:1},8,["modelValue"])]),g("",!0),e("div",Ne,[t[15]||(t[15]=e("label",{for:"language-input",class:"form-label"},"Your card’s language",-1)),T(e("select",{id:"language-input","onUpdate:modelValue":t[9]||(t[9]=o=>n.language=o),class:"language-input"},[t[14]||(t[14]=e("option",{value:""},"Please select",-1)),(a(),i(b,null,x(D,o=>e("option",{key:o,value:o},f(o),9,Te)),64))],512),[[ae,n.language]])]),m(z,{type:"submit",role:"button",disabled:d.value},{default:h(()=>[B(f(d.value?"Saved!":"Save"),1)]),_:1},8,["disabled"])],32))}}),Oe=I(Ge,[["__scopeId","data-v-d21c58b9"]]),q=_=>Array.from(new Set(_.filter(u=>u!=null&&u!==""))),je={key:0},Ee={style:{"margin-bottom":"2rem"}},Le={class:"list"},He={class:"tile-title"},qe=["src"],ze={key:0},We={class:"cards"},Je=["src","alt"],Ke={class:"cards"},Ye=["src","alt"],Qe={class:"card-count"},Xe={class:"tile-footer"},Ze={class:"token-count"},et={key:3},tt=R({__name:"ProposalsView",setup(_){const u=M([]),c=M(!0),n=M(),s=j({raritySelection:[],languageSelection:[],pseudonymSelection:[]}),d=w(()=>u.value.map(r=>r.card1)),v=w(()=>q(u.value.map(r=>r.language))),D=w(()=>q(u.value.map(r=>r.pseudo))),G=w(()=>u.value.reduce((r,l)=>{const p=l.card1.rarityCode,{friend_id:$,icon:k,pseudo:C,language:E}=l;if(s.raritySelection.length&&!s.raritySelection.includes(p)||s.languageSelection.length&&!s.languageSelection.includes(E||"")||s.pseudonymSelection.length&&!s.pseudonymSelection.includes(C||""))return r;const S=r.find(V=>V.rarity===p&&V.friendID===$);return S?(S.wantedCards.every(V=>V.id!==l.card1.id)&&S.wantedCards.push(l.card1),S.givenCards.every(V=>V.id!==l.card2.id)&&S.givenCards.push(l.card2)):r.push({rarity:p,friendID:$,icon:k,pseudo:C,language:E,wantedCards:[l.card1],givenCards:[l.card2]}),r},[])),O=r=>de.value[r]||0,F=r=>{const[l,p]=r.split("-");return{id:r,...ce.find($=>$.set===l&&$.number===parseInt(p))}},y=r=>r.replace(/(\d{4})(\d{4})(\d{4})(\d{4})/,"$1-$2-$3-$4"),t=r=>{switch(r){case"R":return 120;case"RR":return 500;case"AR":return 400}return 0},o=()=>{window.location.reload()};return oe(async()=>{c.value=!0;try{const r=await ie();u.value=r.map(l=>({...l,card1:F(l.card_wanted),card2:F(l.card_to_give)}))}catch(r){n.value=r}c.value=!1}),(r,l)=>(a(),P(W,{style:{padding:"2rem 0"}},{default:h(()=>[c.value?(a(),i("h2",je,"Loading your proposals…")):n.value?(a(),i(b,{key:1},[e("h2",Ee,f(n.value),1),m(z,{onClick:o},{default:h(()=>l[1]||(l[1]=[B("Refresh")])),_:1,__:[1]})],64)):u.value.length>0?(a(),i(b,{key:2},[l[4]||(l[4]=e("h2",null,"You’ve got a match!",-1)),m(re,{modelValue:s,"onUpdate:modelValue":l[0]||(l[0]=p=>s=p),cards:d.value,languages:v.value,pseudonyms:D.value},null,8,["modelValue","cards","languages","pseudonyms"]),e("div",Le,[(a(!0),i(b,null,x(G.value,(p,$)=>(a(),i("div",{class:"exchange-tile",key:$},[e("div",He,[p.icon&&p.icon!=="000"?(a(),i("img",{key:0,src:`/images/avatars/${p.icon}.png`,height:"40px",alt:""},null,8,qe)):g("",!0),e("div",null,[p.pseudo?(a(),i("div",ze,f(p.pseudo),1)):g("",!0),e("div",null,"ID "+f(y(p.friendID)),1)])]),e("div",We,[(a(!0),i(b,null,x(p.wantedCards,(k,C)=>(a(),i("div",{class:"card-container",key:C},[e("img",{src:`/images/cards/thumbnails/${k.imageName}`,alt:k.label.eng,class:"card-image"},null,8,Je)]))),128))]),l[3]||(l[3]=e("div",{class:"exchange-icon"},null,-1)),e("div",Ke,[(a(!0),i(b,null,x(p.givenCards,(k,C)=>(a(),i("div",{class:"card-container",key:C},[e("img",{src:`/images/cards/thumbnails/${k.imageName}`,alt:k.label.eng,class:"card-image"},null,8,Ye),e("span",Qe,f(O(k.id)),1)]))),128))]),e("div",Xe,[B(f(p.language)+" ",1),l[2]||(l[2]=e("img",{src:ue,alt:"Trade Token",class:"trade-token",height:"32"},null,-1)),e("span",Ze,f(t(p.rarity)),1)])]))),128))])],64)):(a(),i("h2",et,l[5]||(l[5]=[B(" No matching proposals for now :( "),e("br",null,null,-1),B(" Please come back later! ")])))]),_:1}))}}),st=I(tt,[["__scopeId","data-v-92f3fe2b"]]),at={key:0,class:"prices"},nt={class:"rarity"},lt=["src","alt","title"],ot=R({__name:"PacksInformations",setup(_){const u=n=>n.reduce((s,d)=>{for(const v of d.packs||[])s[v||""]=(s[v||""]||0)+d.count;return s},{}),c=w(()=>Object.entries(u(H.value)).sort((n,s)=>s[1]-n[1]));return(n,s)=>ve(H).length>0?(a(),i("div",at,[s[0]||(s[0]=e("h3",null,"ℹ️ Best packs matching your wishes :",-1)),(a(!0),i(b,null,x(c.value,([d,v])=>(a(),i("div",{class:"price",key:d},[e("div",nt,[e("img",{src:`/images/packs/${d}.webp`,alt:d,height:"100px",title:d+" booster pack"},null,8,lt)]),e("span",null,f(v)+" cards wanted inside",1)]))),128))])):g("",!0)}}),it=I(ot,[["__scopeId","data-v-f29dc244"]]),rt={class:"aside"},dt={class:"content"},ut={class:"row-xl"},ct=R({__name:"AccountView",setup(_){const u=me(),c=w(()=>u.name),n=w(()=>["wishlist","offers"].includes(c.value??""));return(s,d)=>(a(),i("main",null,[e("div",rt,[e("nav",null,[m(N,{label:"Wishlist",icon:"heart",active:c.value==="wishlist"},null,8,["active"]),m(N,{label:"Offers",icon:"portfolio",active:c.value==="offers"},null,8,["active"]),m(N,{label:"Proposals",icon:"exchange",active:c.value==="proposals"},null,8,["active"]),m(N,{label:"Account",icon:"gear",active:c.value==="account"},null,8,["active"])]),n.value?(a(),P(pe,{key:0,id:"prices",showGiving:c.value==="offers"},null,8,["showGiving"])):g("",!0)]),e("div",dt,[n.value?(a(),P(ge,{key:0,step:c.value==="wishlist"?1:2},null,8,["step"])):g("",!0),c.value==="proposals"?(a(),P(st,{key:1})):g("",!0),c.value==="account"?(a(),P(W,{key:2},{default:h(()=>[e("div",ut,[m(Oe),m(it)])]),_:1})):g("",!0)])]))}}),pt=I(ct,[["__scopeId","data-v-1474198b"]]);export{pt as default};
