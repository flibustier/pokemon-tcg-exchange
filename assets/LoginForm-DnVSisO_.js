import{d as y,D as x,O as k,r as p,c as E,a as i,o as n,P as L,b as d,e as a,v as c,x as m,f as h,t as v,Y as U,Z as V,$ as P,a0 as B,_ as D}from"./app-DmsZdftI.js";const F={key:0,class:"form-group"},S={class:"form-group"},q={for:"email",class:"form-label"},C={key:0},N={class:"form-group"},A={for:"password",class:"form-label"},M={key:0},T=["disabled"],$={key:1,class:"error-message"},O=y({__name:"LoginForm",props:{withoutId:{type:Boolean,default:!1}},emits:["error"],setup(I,{emit:b}){const r=I,g=b,e=x({friendId:k(),email:"",password:""}),u=p(),l=p(!1),f=p(),_=E(()=>!e.email||!e.password?!0:r.withoutId?!1:!e.friendId||e.friendId.length!==16||!/^\d+$/.test(e.friendId)),w=async()=>{l.value=!0;try{let t=!1;r.withoutId?t=await U(e):t=await V(e),t&&(await P(e.email,e.password,f.value),window.location.replace(B.value?"/account/wishlist":"/account/proposals"))}catch(t){t!=="user not found"&&(u.value=t),g("error",t)}finally{l.value=!1}};{const t=new URLSearchParams(window.location.search),s=t.get("email"),o=t.get("token");s&&o&&(e.email=s,e.password=o,f.value=o,w())}return(t,s)=>(n(),i("form",{class:"friend-form",onSubmit:L(w,["prevent"])},[r.withoutId?d("",!0):(n(),i("div",F,[s[3]||(s[3]=a("label",{for:"friendId",class:"form-label"},'Friend ID (16 digits without "-")',-1)),c(a("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>e.friendId=o),required:"",type:"text",id:"friendId",class:"friend-id",placeholder:"0000000000000000",pattern:"\\d{16}",maxlength:"16"},null,512),[[m,e.friendId]])])),a("div",S,[a("label",q,[s[4]||(s[4]=h("Email address ")),r.withoutId?d("",!0):(n(),i("span",C,"(for notifications about exchange proposals)"))]),c(a("input",{type:"email",id:"email",class:"email-input",placeholder:"Enter your email","onUpdate:modelValue":s[1]||(s[1]=o=>e.email=o),required:""},null,512),[[m,e.email]])]),a("div",N,[a("label",A,[s[5]||(s[5]=h("Password ")),r.withoutId?d("",!0):(n(),i("span",M,"(for retrieving your data later)"))]),c(a("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>e.password=o),required:"",type:"password",id:"password",class:"password-input",placeholder:"Enter your password"},null,512),[[m,e.password]])]),a("button",{type:"submit",class:"submit-button",disabled:_.value||l.value},v(l.value?"Loadingâ€¦":r.withoutId?"Sign In":"Create Account"),9,T),u.value?(n(),i("span",$,"Error: "+v(u.value),1)):d("",!0)],32))}}),Y=D(O,[["__scopeId","data-v-62a10b91"]]);export{Y as L};
